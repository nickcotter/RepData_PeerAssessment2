---
title: 'Reproducible Research: Peer Assignment 2'
output: html_document
keep_md: true
---

## Use these libraries
```{r message=FALSE}
library(knitr)
library(dplyr)
library(ggplot2)
```

TODO: Your document should have a title that briefly summarizes your data analysis

## Synopsis
TODO: a synopsis which describes and summarizes your analysis in at most 10 complete sentences.


## Data Processing

Download the file:
```{r}
if(!file.exists("StormData.csv.bz2")) {
  download.file("https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2", "StormData.csv.bz2")
}
```

Reading into the stormdata variable:
```{r stormdataChunk, cache=TRUE}
stormdata <- read.csv("StormData.csv.bz2")
```

```{r}
# show a summary of the data
kable(summary(stormdata))
```






## Questions
* Across the United States, which types of events (as indicated in the EVTYPE variable) are most harmful with respect to population health?
* Across the United States, which types of events have the greatest economic consequences?


These fields are relevant for harm to population:
* FATALITIES	
* INJURIES


These fields are relevant for economic consequences:
* PROPDMG	
* CROPDMG

But what are:
* PROPDMGEXP	
* CROPDMGEXP


```{r}
stormdata$EVTYPE <- as.factor(stormdata$EVTYPE)
stormdata$POPULATION_DAMAGE <- stormdata$FATALITIES + stormdata$INJURIES
stormdataByPopDamage <- aggregate(POPULATION_DAMAGE ~ EVTYPE, data=stormdata, FUN="sum")
stormdataByPopDamage <- arrange(stormdataByPopDamage, desc(POPULATION_DAMAGE))
stormdataByPopDamageTop10 <- stormdataByPopDamage[1:10,]
qplot(stormdataByPopDamageTop10$EVTYPE, data=stormdataByPopDamageTop10, fill=stormdataByPopDamageTop10$EVTYPE,
      geom = "bar", weight=POPULATION_DAMAGE)
```


```{r}
stormdata$ECONOMIC_DAMAGE <- stormdata$PROPDMG + stormdata$CROPDMG
stormdataByEcoDamage <- aggregate(ECONOMIC_DAMAGE ~ EVTYPE, data=stormdata, FUN="sum")
stormdataByEcoDamage <- arrange(stormdataByEcoDamage, desc(ECONOMIC_DAMAGE))
stormdataByEcoDamageTop10 <- stormdataByEcoDamage[1:10,]
qplot(stormdataByEcoDamageTop10$EVTYPE, data=stormdataByEcoDamageTop10, fill=stormdataByEcoDamageTop10$EVTYPE, 
      geom = "bar", weight=ECONOMIC_DAMAGE)
```





## Review Criteria
* Has either a (1) valid RPubs URL pointing to a data analysis document for this assignment been submitted; or (2) a complete PDF file presenting the data analysis been uploaded?
* Is the document written in English?
* Does the analysis include description and justification for any data transformations?
* Does the document have a title that briefly summarizes the data analysis?
* Does the document have a synopsis that describes and summarizes the data analysis in less than 10 sentences?
* Is there a section titled "Data Processing" that describes how the data were loaded into R and processed for analysis?
* Is there a section titled "Results" where the main results are presented?
* Is there at least one figure in the document that contains a plot?
* Are there at most 3 figures in this document?
* Does the analysis start from the raw data file (i.e. the original .csv.bz2 file)?
* Does the analysis address the question of which types of events are most harmful to population health?
* Does the analysis address the question of which types of events have the greatest economic consequences?
* Do all the results of the analysis (i.e. figures, tables, numerical summaries) appear to be reproducible?
* Do the figure(s) have descriptive captions (i.e. there is a description near the figure of what is happening in the figure)?
* As far as you can determine, does it appear that the work submitted for this project is the work of the student who submitted it?